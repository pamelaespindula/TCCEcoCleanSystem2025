<header><h1>Atendimentos Agendados</h1></header>

<ul id="listaAtendimentos">
  <% atendimentos.forEach(atendimento => { %>
    <li>
      <input type="checkbox" class="check-atendimento" data-id="<%= atendimento.id %>"
        <% if (atendimento.status === 'concluído') { %> checked <% } %> />
      <%= atendimento.nome_servico %> - <%= atendimento.data_agendada %> às <%= atendimento.hora_agendada %>
    </li>
  <% }) %>
</ul>

<script>
  document.querySelectorAll('.check-atendimento').forEach(chk => {
    chk.addEventListener('change', async e => {
      const id = e.target.getAttribute('data-id');
      const status = e.target.checked ? 'concluído' : 'pendente';

      await fetch('/atendimentos/' + id, {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ status })
      });
    });
  });
</script>

<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title><%= title || 'EcoCleanSystem' %></title>
  
  <!-- CSS Principal -->
  <link rel="stylesheet" href="/css/layout.css" />
  
  <!-- Navbar CSS -->
  <link rel="stylesheet" href="/css/nav.css" />
  
  <!-- Font Awesome para ícones -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
  
  <!-- CSS Customizado por página -->
  <% if (typeof customCss !== 'undefined' && customCss) { %>
    <link rel="stylesheet" href="<%= customCss %>" />
  <% } %>
  
  <!-- Meta tags adicionais -->
  <meta name="description" content="Sistema de gestão EcoCleanSystem - Controle de atendimentos e materiais" />
  <meta name="theme-color" content="#23224A" />
</head>
<body>
  <!-- Navbar (exceto na página de login) -->
  <% if (!isLoginPage) { %>
    <%- include('partials/nav', { activePage: activePage }) %>
  <% } %>

  <!-- Conteúdo Principal -->
  <main class="main-container">
    <%- body %>
  </main>

  <!-- Scripts Customizados por página -->
  <% if (typeof customScripts !== 'undefined' && customScripts) { %>
    <%= customScripts %>
  <% } %>

  <!-- Scripts Globais -->
  <script>
    // Função global para confirmar ações
    function confirmAction(message) {
      return confirm(message || 'Tem certeza que deseja realizar esta ação?');
    }

    // Função para mostrar mensagens de feedback
    function showMessage(message, type = 'info') {
      // Implementação básica - pode ser expandida
      alert(message);
    }

    // Prevenir envio duplo de formulários
    document.addEventListener('DOMContentLoaded', function() {
      const forms = document.querySelectorAll('form');
      forms.forEach(form => {
        form.addEventListener('submit', function(e) {
          const submitBtn = this.querySelector('button[type="submit"]');
          if (submitBtn) {
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processando...';
            
            // Reativa após 5 segundos caso haja erro
            setTimeout(() => {
              submitBtn.disabled = false;
              submitBtn.innerHTML = submitBtn.getAttribute('data-original-text') || 'Enviar';
            }, 5000);
          }
        });
      });
    });
  </script>
</body>
</html>